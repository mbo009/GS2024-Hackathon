<!DOCTYPE html>
<html>

<head>
    <title>Vulnerability Report</title>
    <style>
        /* General Styles */
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #0d1117;
            color: #c9d1d9;
            transition: background-color 0.3s, color 0.3s;
        }

        h1 {
            color: #58a6ff;
            text-align: center;
        }

        table {
            width: 80%;
            margin: 20px auto;
            border-collapse: collapse;
            background-color: #161b22;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }

        th, td {
            border: 1px solid #30363d;
            padding: 12px;
            text-align: center;
        }

        th {
            background-color: #238636;
            color: white;
            font-weight: bold;
        }

        tr:hover {
            background-color: #30363d;
        }

        td {
            font-size: 16px;
        }

        caption {
            caption-side: top;
            font-size: 18px;
            margin-bottom: 10px;
        }

        /* Conditional Styling */
        .all-passed {
            background-color: #27ae60; /* Green for all passed */
            color: white;
            font-weight: bold;
        }

        .not-all-passed {
            background-color: #e74c3c; /* Red for some failed */
            color: white;
            font-weight: bold;
        }

        /* Styling for hidden details */
        .test-details {
            background-color: #2d333b;
            color: #58a6ff;
            padding: 15px;
            font-size: 14px;
            display: none;
            text-align: left;
        }

        .test-details td {
            padding-left: 30px; /* Indentation to make it look like nested content */
        }

        .test-details strong {
            color: #c9d1d9;
        }

        /* Ensuring smooth toggling */
        tr {
            cursor: pointer;
        }
    </style>
    <script>
        function toggleDetails(row) {
            var details = row.nextElementSibling; // Get the next sibling (the details row)
            if (details.style.display === 'none' || details.style.display === '') {
                details.style.display = 'table-row'; // Display the details as a row
            } else {
                details.style.display = 'none'; // Hide the details
            }
        }
    </script>
</head>

<body>
    <h1>Vulnerability Report</h1>
    <table>
        <caption>Summary of Test Results</caption>
        <thead>
            <tr>
                <th>Vulnerability Type</th>
                <th>Tests Passed</th>
            </tr>
        </thead>
        <tbody>
            {% for name, testsPassed, testsTotal, details in data %}
            <tr class="{% if testsPassed == testsTotal %}all-passed{% else %}not-all-passed{% endif %}" onclick="toggleDetails(this)">
                <td>{{ name }}</td>
                <td>{{ testsPassed }}/{{ testsTotal }}</td>
            </tr>
            <!-- Hidden details row that appears below the clicked row -->
            <tr class="test-details">
                <td colspan="2">
                    {% for endpoint, description in details %}
                        <strong>Endpoint:</strong> {{ endpoint }}<br>
                        <strong>Description:</strong> {{ description }}<br><br>
                    {% endfor %}
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</body>

</html>
